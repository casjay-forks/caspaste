# Test docker-compose - AI/AUTOMATED TESTING ONLY
# Per AI.md PART 29: AI copies this to temp dir, runs from there
# ./rootfs paths resolve to $TEMP_DIR/rootfs when run from temp directory
name: caspaste-test

services:
  app:
    image: caspaste:test
    container_name: caspaste-test
    hostname: caspaste-test
    restart: "no"
    environment:
      - PORT=80
      - TZ=UTC
      - CASPASTE_DB_DRIVER=sqlite
      - CASPASTE_MODE=development
    ports:
      - '18080:80'
    volumes:
      - './rootfs/config:/config:z'
      - './rootfs/data:/data:z'
    healthcheck:
      test: ["CMD", "caspaste", "--status"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s
